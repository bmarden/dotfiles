# Kitty theme
include ~/.config/kitty/themes/onedarkpro_onedark_dark.conf

#: kitty has very powerful font management. You can configure
#: individual font faces and even specify special fonts for particular
#: characters.
font_family      family="FiraCode Nerd Font Mono" style=Retina
# font_family family="MonaLisa"
# font_family      family="Hack Nerd Font Mono"
bold_font        auto
italic_font      auto
bold_italic_font auto
# font_family      family='Monaspace Neon NF' style='Regular'
# bold_font        family='Monaspace Neon NF' postscript_name=MonaspaceNeonNF-Bold
# italic_font      auto
# bold_italic_font family='Monaspace Neon NF' postscript_name=MonaspaceNeonNF-BoldItalic
# font_family      family='Monaspace Argon NF' style='Regular'
# bold_font        family='Monaspace Argon NF' postscript_name=MonaspaceArgonNF-Bold
# italic_font      auto
# bold_italic_font family='Monaspace Argon NF' postscript_name=MonaspaceArgonNF-BoldItalic

font_size 12

# Nerd Fonts v3.3.0
symbol_map U+e000-U+e00a,U+ea60-U+ebeb,U+e0a0-U+e0c8,U+e0ca,U+e0cc-U+e0d7,U+e200-U+e2a9,U+e300-U+e3e3,U+e5fa-U+e6b7,U+e700-U+e8ef,U+ed00-U+efc1,U+f000-U+f2ff,U+f000-U+f2e0,U+f300-U+f381,U+f400-U+f533,U+f0001-U+f1af0 Symbols Nerd Font Mono

# Smart split configuration
map ctrl+j neighboring_window down
map ctrl+k neighboring_window up
map ctrl+h neighboring_window left
map ctrl+l neighboring_window right

# Unset the mapping to pass the keys to neovim
map --when-focus-on var:IS_NVIM ctrl+j
map --when-focus-on var:IS_NVIM ctrl+k
map --when-focus-on var:IS_NVIM ctrl+h
map --when-focus-on var:IS_NVIM ctrl+l

# the 3 here is the resize amount, adjust as needed
map cmd+j kitten relative_resize.py down  3
map cmd+k kitten relative_resize.py up    3
map cmd+h kitten relative_resize.py left  3
map cmd+l kitten relative_resize.py right 3

map --when-focus-on var:IS_NVIM cmd+j
map --when-focus-on var:IS_NVIM cmd+k
map --when-focus-on var:IS_NVIM cmd+h
map --when-focus-on var:IS_NVIM cmd+l

# Allow remote control of kitty for vim-kitty-navigator
allow_remote_control yes
listen_on unix:/tmp/mykitty

# Make new windows open with the current working directory
map cmd+enter launch --cwd=current

#: Note that this refers to programming ligatures, typically
#: implemented using the calt OpenType feature. For disabling general
#: ligatures, use the font_features option.

# font_features
font_features MonaspaceArgonNF-Regular +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-Bold +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-BoldItalic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-Italic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-Medium +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-MediumItalic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-SemiBold +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceArgonNF-SemiBoldItalic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09

font_features MonaspaceNeonNF-Regular +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-Bold +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-BoldItalic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-Italic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-Medium +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-MediumItalic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-SemiBold +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09
font_features MonaspaceNeonNF-SemiBoldItalic +dlig +ss01 +ss02 +ss03 +ss04 +ss05 +ss06 +ss07 +ss08 +ss09

#: Choose exactly which OpenType features to enable or disable. Note
#: that for the main fonts, features can be specified when selecting
#: the font using the choose-fonts kitten. This setting is useful for
#: fallback fonts.

##############################################################################
#                        kitty-scrollback.nvim config                        #
##############################################################################
#

# Increase default scrollback buffer size
scrollback_lines 10000

# # This was recommended by justinmk (neovim core contributor) here:
# # https://www.reddit.com/r/neovim/comments/1nmqjal/comment/nfiif2z/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button
# # These 2 options below didn't work for me, because I'm running NVIM v0.11.4, and 0.12 is required
# scrollback_pager nvim --cmd 'call nvim_open_term(0, {})' +'set eventignore=FileType' +'nnoremap q ZQ' +'set nomodified nolist' +'$' -
# scrollback_pager nvim --cmd 'set eventignore=FileType' +'nnoremap q ZQ' +'set nomodified readonly nolist' +'TermHl' +'$' -
# map kitty_mod+z show_scrollback

# This is a command I came up with, allows me to call my own neovim config and
# also disable some plugins that I don't need using the simpler_scrollback var
# map kitty_mod+i launch --stdin-source=@screen_scrollback --type=overlay /bin/zsh -c "SIMPLER_SCROLLBACK=kitty-scrollback nvim +$ +'nnoremap q ZQ'"

# kitty-scrollback.nvim Kitten alias
action_alias kitty_scrollback_nvim kitten /Users/bmarden/.local/share/nvim/lazy/kitty-scrollback.nvim/python/kitty_scrollback_nvim.py
# Browse scrollback buffer in nvim
map kitty_mod+h kitty_scrollback_nvim
# Browse output of the last shell command in nvim
map kitty_mod+g kitty_scrollback_nvim --config ksb_builtin_last_cmd_output
# Show clicked command output in nvim
mouse_map ctrl+shift+right press ungrabbed combine : mouse_select_command_output : kitty_scrollback_nvim --config ksb_builtin_last_visited_cmd_output

#: The audio bell. Useful to disable it in environments that require
#: silence.
enable_audio_bell no
visual_bell_duration 0.0

#: A template to render the tab title. The default just renders the
#: title with optional symbols for bell and activity. If you wish to
#: include the tab-index as well, use something like: {index}:{title}.
# tab_title_template "{fmt.fg.red}{bell_symbol}{activity_symbol}{fmt.fg.tab}{tab.last_focused_progress_percent}{title}"
# tab_title_template "{index}: {title[title.rfind('/')+1:]}" 
tab_title_template "{tab.active_wd.rsplit('/', 1)[-1]}"

#: Use the Option key as an Alt key on macOS. With this set to no,
#: kitty will use the macOS native Option+Key to enter Unicode
#: character behavior. This will break any Alt+Key keyboard shortcuts
#: in your terminal programs, but you can use the macOS Unicode input
#: technique. You can use the values: left, right or both to use only
#: the left, right or both Option keys as Alt, instead. Note that
#: kitty itself always treats Option the same as Alt. This means you
#: cannot use this option to configure different kitty shortcuts for
#: Option+Key vs. Alt+Key. Also, any kitty shortcuts using
#: Option/Alt+Key will take priority, so that any such key presses
#: will not be passed to terminal programs running inside kitty.
#: Changing this option by reloading the config is not supported.
macos_option_as_alt yes

# Make kitty borderless
# "yes" disables round corners and hides the title bar 
# "titlebar-only" leaves round corners but hides title bar
# hide_window_decorations yes
hide_window_decorations titlebar-only

#: The window padding (in pts) (blank area between the text and the
#: window border). A single value sets all four sides. Two values set
#: the vertical and horizontal sides. Three values set top, horizontal
#: and bottom. Four values set top, right, bottom and left.
# window_padding_width 5 5 0 0
# window_padding_width 1 4 1 4
window_padding_width 3 5 2 2
# window_padding_width 0

# Set initial window size
initial_window_height 300

#: The edge to show the tab bar on, top or bottom.
tab_bar_edge top

#: The tab bar style, can be one of:
#: fade
#:     Each tab's edges fade into the background color. (See also tab_fade)
#: slant
#:     Tabs look like the tabs in a physical file.
#: separator
#:     Tabs are separated by a configurable separator. (See also
#:     tab_separator)
#: powerline
#:     Tabs are shown as a continuous line with "fancy" separators.
#:     (See also tab_powerline_style)
#: custom
#:     A user-supplied Python function called draw_tab is loaded from the file
#:     tab_bar.py in the kitty config directory. For examples of how to
#:     write such a function, see the functions named draw_tab_with_* in
#:     kitty's source code: kitty/tab_bar.py. See also
#:     this discussion <https://github.com/kovidgoyal/kitty/discussions/4447>
#:     for examples from kitty users.
#: hidden
#:     The tab bar is hidden. If you use this, you might want to create
#:     a mapping for the select_tab action which presents you with a list of
#:     tabs and allows for easy switching to a tab.
tab_bar_style fade 

# The default is ctrl+shift
# kitty_mod cmd+option

#: Close window
map kitty_mod+w close_window


# Kitty Sessions section

# Save current state to a session file (prompts for path, opens in $EDITOR)
# Also specify the filename when saving the session:
# ~/.cache/kitty/dotfiles.kitty-session
map ctrl+shift+s save_as_session --use-foreground-process --base-dir ~/.local/share/kitty/sessions --match=session:.

# This is similar to tmux prefix + key
map ctrl+b>d goto_session ~/.local/share/kitty/sessions/dotfiles.kitty-session
map ctrl+b>b goto_session ~/.local/share/kitty/sessions/backend-turnkey.kitty-session
map ctrl+b>o goto_session ~/.local/share/kitty/sessions/obsidian.kitty-session
# map ctrl+b>h goto_session ~/.local/share/kitty/sessions/home.kitty-session
# map ctrl+b>p goto_session ~/.local/share/kitty/sessions/dots-private.kitty-session
# map ctrl+b>a goto_session ~/.local/share/kitty/sessions/lua.kitty-session
# map ctrl+b>k goto_session ~/.local/share/kitty/sessions/skitty.kitty-session
# map ctrl+b>; goto_session ~/.local/share/kitty/sessions/scripts.kitty-session

# Switch to alternate kitty session or previous session
map ctrl+b>l goto_session -1
# map ctrl+b>l combine : goto_session -1 : update_kitty_name

# Browse and select from the list of known projects defined via goto_session commands
map ctrl+b>s goto_session

# kitty tab bar only shows tabs from the currently active session
# this works even if all the sessions run in the same os window
# https://github.com/kovidgoyal/kitty/issues/8911#issuecomment-3222346493
tab_bar_filter session:~ or session:^$

# When I open a new tab in a session, I want this tab to only show for that
# session
# https://github.com/kovidgoyal/kitty/issues/8911#issuecomment-3224876629
map cmd+t new_tab_with_cwd
